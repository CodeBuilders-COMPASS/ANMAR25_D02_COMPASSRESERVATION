

datasource db {
  provider = "mysql" 
  url      = env("DATABASE_URL") 
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id    Int     @id @default(autoincrement()) 
  name  String  @db.VarChar(50) 
  email String  @unique @db.VarChar(50) 
  password String  @db.VarChar(50) 
  phone  String?   @db.VarChar(20) 
  created_at DateTime @default(now()) 
  updated_at DateTime @updatedAt 
  status UserStatus @default(ACTIVE) 

  @@map("users") 
}


enum UserStatus {
  ACTIVE
  INACTIVE
}

model Client {
  id         Int      @id @default(autoincrement())
  name       String   @db.VarChar(50)
  cpf        String   @unique @db.VarChar(14)
  birth_date DateTime
  email      String   @unique @db.VarChar(50)
  phone      String   @db.VarChar(20)
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  status     ClientStatus @default(ACTIVE)

  @@map("clients")
}

enum ClientStatus {
  ACTIVE
  INACTIVE
}

model Space {
  id          Int      @id @default(autoincrement())
  name        String   @unique @db.VarChar(50)
  description String   @db.Text
  capacity    Int
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
  status      SpaceStatus @default(ACTIVE)

  @@map("spaces")
}

enum SpaceStatus {
  ACTIVE
  INACTIVE
}

model Resource {
  id          Int      @id @default(autoincrement())
  name        String   @unique @db.VarChar(50)
  quantity    Int
  description String?  @db.Text
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
  status      ResourceStatus @default(ACTIVE)

  @@map("resources")
}

enum ResourceStatus {
  ACTIVE
  INACTIVE
}

model Reservation {
  id        Int      @id @default(autoincrement())
  user_id   Int
  space_id  Int
  client_id Int
  start_date DateTime
  end_date   DateTime
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  status      ReservationStatus @default(OPEN)
  closed_at DateTime?

  @@map("reservations")
}

enum ReservationStatus {
  OPEN
  APPROVED
  CLOSED
  CANCELLED
}

model SpaceResource {
  space_id    Int
  resource_id Int

  @@id([space_id, resource_id])
  @@map("space_resources")
}

model ReservationResource {
  reservation_id Int
  resource_id    Int
  quantity       Int @default(1)

  @@id([reservation_id, resource_id])
  @@map("reservation_resources")
}
